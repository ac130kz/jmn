package org.netbeans.modules.musician.actions;

import org.openide.awt.ActionID;
import org.openide.awt.ActionReference;
import org.openide.awt.ActionReferences;
import org.openide.awt.ActionRegistration;
import org.openide.cookies.SaveCookie;
import org.openide.nodes.Node;
import org.openide.util.HelpCtx;
import org.openide.util.NbBundle;
import org.openide.util.actions.CookieAction;

@ActionID(id = "org.netbeans.modules.musician.actions.SaveAction", category = "System")
@ActionRegistration(displayName = "#CTL_SaveAction")
@ActionReferences(value = {
    @ActionReference(path = "Menu/File"),
    @ActionReference(path = "Toolbars/JFugue")})
public final class SaveAction extends CookieAction {
    
    protected void performAction(Node[] activatedNodes) {
        SaveCookie c = (SaveCookie) activatedNodes[0].getCookie(SaveCookie.class);
        // TODO use c
//        java.util.Date date = new java.util.Date();
//        String good = " abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789#[]_";
//        String result = "";
//
//        int editorLength = editor_instance.findInstance().getSong("s").length();
//        String editorCharacters = editor_instance.findInstance().getSong("s");
//        
//        for ( int i = 0; i < editorLength; i++ ) {
//            if ( good.indexOf(editorCharacters.charAt(i)) >= 0 )
//                result += editorCharacters.charAt(i);
//        }
//        
//        Player player = new Player();
//        Pattern pattern = new Pattern(result);
//        player.play(pattern);
//        player.save(pattern,"MidiFromMusicNotePad-" + date.getTime() + ".midi");
//        
//        StatusDisplayer.getDefault().setStatusText("Successfully saved!");
        
    }
    
    protected int mode() {
        return CookieAction.MODE_EXACTLY_ONE;
    }
    
    public String getName() {
        return NbBundle.getMessage(SaveAction.class, "CTL_SaveAction");
    }
    
    protected Class[] cookieClasses() {
        return new Class[] {
            SaveCookie.class
        };
    }
    
    protected String iconResource() {
        return "org/netbeans/modules/musician/resources/Save16.gif";
    }
    
    public HelpCtx getHelpCtx() {
        return HelpCtx.DEFAULT_HELP;
    }
    
    protected boolean asynchronous() {
        return false;
    }
    
}

